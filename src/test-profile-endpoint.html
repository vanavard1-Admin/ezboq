<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üîç Test Profile Endpoints</title>
  <style>
    body {
      font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 40px 20px;
      margin: 0;
      min-height: 100vh;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    h1 {
      margin: 0 0 10px 0;
      color: #1a202c;
      font-size: 32px;
      font-weight: 700;
    }
    
    .subtitle {
      color: #718096;
      margin: 0 0 30px 0;
      font-size: 16px;
    }
    
    .test-section {
      background: #f7fafc;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
      border: 2px solid #e2e8f0;
    }
    
    .test-section h2 {
      margin: 0 0 16px 0;
      color: #2d3748;
      font-size: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      width: 100%;
      margin-bottom: 12px;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    .result {
      margin-top: 16px;
      padding: 16px;
      border-radius: 8px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      overflow-x: auto;
      white-space: pre-wrap;
      word-break: break-all;
    }
    
    .result.success {
      background: #f0fdf4;
      border: 2px solid #86efac;
      color: #166534;
    }
    
    .result.error {
      background: #fef2f2;
      border: 2px solid #fca5a5;
      color: #991b1b;
    }
    
    .result.info {
      background: #eff6ff;
      border: 2px solid #93c5fd;
      color: #1e40af;
    }
    
    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
      margin-left: 10px;
    }
    
    .status-badge.pending {
      background: #fef3c7;
      color: #92400e;
    }
    
    .status-badge.success {
      background: #d1fae5;
      color: #065f46;
    }
    
    .status-badge.error {
      background: #fee2e2;
      color: #991b1b;
    }
    
    .endpoint-url {
      background: #1e293b;
      color: #e2e8f0;
      padding: 12px;
      border-radius: 6px;
      margin: 12px 0;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      overflow-x: auto;
    }
    
    .method {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: 600;
      font-size: 12px;
      margin-right: 8px;
    }
    
    .method.get {
      background: #dbeafe;
      color: #1e40af;
    }
    
    .method.post {
      background: #d1fae5;
      color: #065f46;
    }
    
    .method.put {
      background: #fef3c7;
      color: #92400e;
    }
    
    .instructions {
      background: #fff7ed;
      border-left: 4px solid #f97316;
      padding: 16px;
      margin-bottom: 24px;
      border-radius: 8px;
    }
    
    .instructions h3 {
      margin: 0 0 8px 0;
      color: #9a3412;
      font-size: 16px;
    }
    
    .instructions p {
      margin: 0;
      color: #7c2d12;
      line-height: 1.6;
    }
    
    .instructions code {
      background: #fed7aa;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîç Test Profile Endpoints</h1>
    <p class="subtitle">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Profile API endpoints ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</p>
    
    <div class="instructions">
      <h3>‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç! ‡∏ï‡πâ‡∏≠‡∏á RESTART server ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h3>
      <p>
        1. ‡∏Å‡∏î <code>Ctrl+C</code> ‡πÉ‡∏ô terminal ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô server<br>
        2. ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á: <code>npm run dev</code><br>
        3. ‡∏£‡∏≠‡∏à‡∏ô‡πÄ‡∏´‡πá‡∏ô "Server started on port 54321"<br>
        4. ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ
      </p>
    </div>
    
    <!-- Test 1: Health Check -->
    <div class="test-section">
      <h2>
        <span>üè•</span>
        Test 1: Health Check
        <span class="status-badge pending" id="health-status">PENDING</span>
      </h2>
      <div class="endpoint-url">
        <span class="method get">GET</span>
        /make-server-6e95bca3/health
      </div>
      <button onclick="testHealth()">‚ñ∂Ô∏è Test Health Endpoint</button>
      <div id="health-result"></div>
    </div>
    
    <!-- Test 2: Get Profile -->
    <div class="test-section">
      <h2>
        <span>üë§</span>
        Test 2: Get Profile (NEW!)
        <span class="status-badge pending" id="profile-status">PENDING</span>
      </h2>
      <div class="endpoint-url">
        <span class="method get">GET</span>
        /make-server-6e95bca3/profile/test-user-123
      </div>
      <button onclick="testGetProfile()">‚ñ∂Ô∏è Test Get Profile</button>
      <div id="profile-result"></div>
    </div>
    
    <!-- Test 3: Update Profile -->
    <div class="test-section">
      <h2>
        <span>üíæ</span>
        Test 3: Update Profile (NEW!)
        <span class="status-badge pending" id="update-status">PENDING</span>
      </h2>
      <div class="endpoint-url">
        <span class="method put">PUT</span>
        /make-server-6e95bca3/profile/test-user-123
      </div>
      <button onclick="testUpdateProfile()">‚ñ∂Ô∏è Test Update Profile</button>
      <div id="update-result"></div>
    </div>
    
    <!-- Test 4: Team Members -->
    <div class="test-section">
      <h2>
        <span>üë•</span>
        Test 4: Team Members (NEW!)
        <span class="status-badge pending" id="team-status">PENDING</span>
      </h2>
      <div class="endpoint-url">
        <span class="method get">GET</span>
        /make-server-6e95bca3/team/members/test-user-123
      </div>
      <button onclick="testTeamMembers()">‚ñ∂Ô∏è Test Team Members</button>
      <div id="team-result"></div>
    </div>
    
    <!-- Test All Button -->
    <button onclick="testAll()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); margin-top: 20px; font-size: 18px; padding: 16px;">
      üöÄ Test All Endpoints
    </button>
  </div>
  
  <script>
    const API_BASE = 'http://localhost:54321/functions/v1';
    
    function showResult(elementId, type, message) {
      const el = document.getElementById(elementId);
      el.className = `result ${type}`;
      el.textContent = message;
    }
    
    function updateStatus(statusId, type) {
      const el = document.getElementById(statusId);
      el.className = `status-badge ${type}`;
      el.textContent = type.toUpperCase();
    }
    
    async function testHealth() {
      console.log('Testing health endpoint...');
      updateStatus('health-status', 'pending');
      
      try {
        const response = await fetch(`${API_BASE}/make-server-6e95bca3/health`);
        const data = await response.json();
        
        if (response.ok && data.status === 'ok') {
          showResult('health-result', 'success', `‚úÖ SUCCESS (${response.status})\n\n${JSON.stringify(data, null, 2)}`);
          updateStatus('health-status', 'success');
        } else {
          showResult('health-result', 'error', `‚ùå UNEXPECTED RESPONSE (${response.status})\n\n${JSON.stringify(data, null, 2)}`);
          updateStatus('health-status', 'error');
        }
      } catch (error) {
        showResult('health-result', 'error', `‚ùå ERROR\n\n${error.message}\n\n‚ö†Ô∏è Server ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î! ‡∏£‡∏±‡∏ô: npm run dev`);
        updateStatus('health-status', 'error');
      }
    }
    
    async function testGetProfile() {
      console.log('Testing get profile endpoint...');
      updateStatus('profile-status', 'pending');
      
      try {
        const response = await fetch(`${API_BASE}/make-server-6e95bca3/profile/test-user-123`);
        const data = await response.json();
        
        if (response.ok) {
          showResult('profile-result', 'success', `‚úÖ SUCCESS (${response.status})\n\nFree Plan created: ${data.membership ? 'YES ‚úÖ' : 'NO ‚ùå'}\n\n${JSON.stringify(data, null, 2)}`);
          updateStatus('profile-status', 'success');
        } else if (response.status === 404) {
          showResult('profile-result', 'error', `‚ùå 404 NOT FOUND\n\n‚ö†Ô∏è ENDPOINT ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ!\n\n‡∏ï‡πâ‡∏≠‡∏á RESTART SERVER:\n1. Ctrl+C\n2. npm run dev\n3. ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà`);
          updateStatus('profile-status', 'error');
        } else {
          showResult('profile-result', 'error', `‚ùå ERROR (${response.status})\n\n${JSON.stringify(data, null, 2)}`);
          updateStatus('profile-status', 'error');
        }
      } catch (error) {
        showResult('profile-result', 'error', `‚ùå ERROR\n\n${error.message}\n\n‚ö†Ô∏è Server ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î! ‡∏£‡∏±‡∏ô: npm run dev`);
        updateStatus('profile-status', 'error');
      }
    }
    
    async function testUpdateProfile() {
      console.log('Testing update profile endpoint...');
      updateStatus('update-status', 'pending');
      
      try {
        const testData = {
          name: 'Test User',
          email: 'test@example.com',
          phone: '0812345678',
          companyName: 'Test Company Ltd.'
        };
        
        const response = await fetch(`${API_BASE}/make-server-6e95bca3/profile/test-user-123`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(testData)
        });
        
        const data = await response.json();
        
        if (response.ok && data.success) {
          showResult('update-result', 'success', `‚úÖ SUCCESS (${response.status})\n\nProfile updated!\n\n${JSON.stringify(data, null, 2)}`);
          updateStatus('update-status', 'success');
        } else if (response.status === 404) {
          showResult('update-result', 'error', `‚ùå 404 NOT FOUND\n\n‚ö†Ô∏è ENDPOINT ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ!\n\n‡∏ï‡πâ‡∏≠‡∏á RESTART SERVER:\n1. Ctrl+C\n2. npm run dev\n3. ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà`);
          updateStatus('update-status', 'error');
        } else {
          showResult('update-result', 'error', `‚ùå ERROR (${response.status})\n\n${JSON.stringify(data, null, 2)}`);
          updateStatus('update-status', 'error');
        }
      } catch (error) {
        showResult('update-result', 'error', `‚ùå ERROR\n\n${error.message}\n\n‚ö†Ô∏è Server ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î! ‡∏£‡∏±‡∏ô: npm run dev`);
        updateStatus('update-status', 'error');
      }
    }
    
    async function testTeamMembers() {
      console.log('Testing team members endpoint...');
      updateStatus('team-status', 'pending');
      
      try {
        const response = await fetch(`${API_BASE}/make-server-6e95bca3/team/members/test-user-123`);
        const data = await response.json();
        
        if (response.ok) {
          showResult('team-result', 'success', `‚úÖ SUCCESS (${response.status})\n\nMembers: ${data.members?.length || 0}\n\n${JSON.stringify(data, null, 2)}`);
          updateStatus('team-status', 'success');
        } else if (response.status === 404) {
          showResult('team-result', 'error', `‚ùå 404 NOT FOUND\n\n‚ö†Ô∏è ENDPOINT ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ!\n\n‡∏ï‡πâ‡∏≠‡∏á RESTART SERVER:\n1. Ctrl+C\n2. npm run dev\n3. ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà`);
          updateStatus('team-status', 'error');
        } else {
          showResult('team-result', 'error', `‚ùå ERROR (${response.status})\n\n${JSON.stringify(data, null, 2)}`);
          updateStatus('team-status', 'error');
        }
      } catch (error) {
        showResult('team-result', 'error', `‚ùå ERROR\n\n${error.message}\n\n‚ö†Ô∏è Server ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î! ‡∏£‡∏±‡∏ô: npm run dev`);
        updateStatus('team-status', 'error');
      }
    }
    
    async function testAll() {
      console.log('üöÄ Testing all endpoints...');
      await testHealth();
      await new Promise(r => setTimeout(r, 500));
      await testGetProfile();
      await new Promise(r => setTimeout(r, 500));
      await testUpdateProfile();
      await new Promise(r => setTimeout(r, 500));
      await testTeamMembers();
      console.log('‚úÖ All tests complete!');
    }
    
    // Auto-run health check on load
    window.addEventListener('load', () => {
      setTimeout(testHealth, 500);
    });
  </script>
</body>
</html>
